<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
        <script src="jquery.js"></script>
        <script>
            function SelectFile() {
                var promise = $.Deferred();
                var input = $("<input type='file'/>");
                if (ischrome) {
                    //chrome是使用的非阻塞 选择文件是不会中断主线程的js执行的

                    input.change(function () {
                        promise.resolve(this.files);
                    });
                    input.click();
                } else {
                    //ie firefo是阻塞的 选择文件会中断主线程的js执行
                    input.click();
                    var files = input[0].files;
                    if (files.length > 0) {
                        promise.resolve(files);
                    }
                }
                return promise;
            }
            $(document).ready(function () {
                $("button").click(function () {
                    var selectfile = SelectFile();
                    selectfile.done(function (files) {
                        console.log("用户选择的文件为：");
                        console.log(files);
                    })
                })
            })
        </script>
    </head>
    <body>
        <button>请选择文件</button>
    </body>
</html>
